DELIMITER $$

CREATE OR REPLACE TRIGGER ORA_SALES.TRG_ORDER_FACT_BI
BEFORE INSERT ON ORA_SALES.ORDER_FACT
FOR EACH ROW
BEGIN
    IF :NEW.ORDER_ID IS NULL THEN
        SELECT ORA_SALES.SEQ_ORDER.NEXTVAL INTO :NEW.ORDER_ID FROM DUAL;
    END IF;
    IF :NEW.ORDER_CODE IS NULL THEN
        :NEW.ORDER_CODE := 'ORD-' || TO_CHAR(ORA_SALES.SEQ_ORDER.NEXTVAL);
    END IF;
END;
$$

