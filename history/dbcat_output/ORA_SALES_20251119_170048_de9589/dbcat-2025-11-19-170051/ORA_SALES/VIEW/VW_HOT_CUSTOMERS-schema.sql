
CREATE OR REPLACE VIEW "ORA_SALES"."VW_HOT_CUSTOMERS" (
	"CUSTOMER_ID",
	"CUSTOMER_NAME",
	"STATUS",
	"TOTAL_SALES") AS 
SELECT c.CUSTOMER_ID,
       c.CUSTOMER_NAME,
       c.STATUS,
       SUM(o.ORDER_TOTAL) AS TOTAL_SALES
  FROM ORA_SALES.CUSTOMER_DIM c
  JOIN ORA_SALES.ORDER_FACT o ON o.CUSTOMER_ID = c.CUSTOMER_ID
 WHERE o.STATUS = 'C'
 GROUP BY c.CUSTOMER_ID, c.CUSTOMER_NAME, c.STATUS;

