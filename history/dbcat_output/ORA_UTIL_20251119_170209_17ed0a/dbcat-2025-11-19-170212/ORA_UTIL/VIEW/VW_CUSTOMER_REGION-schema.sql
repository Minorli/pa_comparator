
CREATE OR REPLACE VIEW "ORA_UTIL"."VW_CUSTOMER_REGION" (
	"CUSTOMER_ID",
	"CUSTOMER_NAME",
	"REGION_CODE",
	"REGION_NAME",
	"ORDER_CNT",
	"TOTAL_SALES") AS 
SELECT c.CUSTOMER_ID,
       c.CUSTOMER_NAME,
       r.REGION_CODE,
       r.REGION_NAME,
       COUNT(o.ORDER_ID) AS ORDER_CNT,
       NVL(SUM(o.ORDER_TOTAL),0) AS TOTAL_SALES
  FROM ORA_UTIL.SYN_CUSTOMER c
  LEFT JOIN ORA_UTIL.SYN_REGION r ON r.REGION_ID = c.REGION_ID
  LEFT JOIN ORA_UTIL.SYN_ORDER o ON o.CUSTOMER_ID = c.CUSTOMER_ID
 GROUP BY c.CUSTOMER_ID, c.CUSTOMER_NAME, r.REGION_CODE, r.REGION_NAME;

