# Hydra Matrix remap matrix (Oracle source -> OceanBase target)
# Fifteen OceanBase schemas receive objects from ten Oracle schemas, producing dense cross-schema hops.

# ORA_REF lookup objects spreading across OB_REF/OB_STAGE/OB_SHARE
ORA_REF.REGION_DIM              = OB_REF.REGION_DIM
ORA_REF.CHANNEL_DIM             = OB_STAGE.CHANNEL_DIM
ORA_REF.SERVICE_LEVEL           = OB_STAGE.SERVICE_LEVEL
ORA_REF.SHIP_METHOD             = OB_STAGE.SHIP_METHOD
ORA_REF.SEQ_REGION              = OB_REF.SEQ_REGION
ORA_REF.SEQ_CHANNEL             = OB_STAGE.SEQ_CHANNEL
ORA_REF.SEQ_SERVICE             = OB_STAGE.SEQ_SERVICE
ORA_REF.SEQ_SHIP_METHOD         = OB_STAGE.SEQ_SHIP_METHOD
ORA_REF.SP_REFRESH_LOOKUP       = OB_SHARE.SP_REFRESH_LOOKUP

# ORA_CORE customer domain
ORA_CORE.CUSTOMER_DIM           = OB_MASTER.CUSTOMER_DIM
ORA_CORE.ADDRESS_DIM            = OB_ODS.ADDRESS_DIM
ORA_CORE.SEQ_CUSTOMER           = OB_MASTER.SEQ_CUSTOMER
ORA_CORE.SP_PROFILE_REFRESH     = OB_APP.SP_PROFILE_REFRESH
ORA_CORE.PKG_CUSTOMER_API       = OB_APP.PKG_CUSTOMER_API
ORA_CORE.PKG_CUSTOMER_API BODY  = OB_APP.PKG_CUSTOMER_API BODY

# ORA_ORD ordering domain
ORA_ORD.ORDER_FACT              = OB_DW.F_ORDER
ORA_ORD.ORDER_LINE              = OB_DW.F_ORDER_LINE
ORA_ORD.SEQ_ORDER               = OB_APP.SEQ_ORDER_FLOW
ORA_ORD.TRG_ORDER_FACT_BI       = OB_DW.TRG_F_ORDER_BI
ORA_ORD.SP_REPRICE_LINE         = OB_APP.SP_REPRICE_LINE
ORA_ORD.FN_ORDER_MARGIN         = OB_APP.FN_ORDER_MARGIN
ORA_ORD.PKG_ORDER_WORKFLOW      = OB_APP.PKG_ORDER_WORKFLOW
ORA_ORD.PKG_ORDER_WORKFLOW BODY = OB_APP.PKG_ORDER_WORKFLOW BODY
ORA_ORD.VW_OPEN_ORDERS          = OB_ANALYTICS.VW_OPEN_ORDERS

# ORA_FULFILL logistics domain
ORA_FULFILL.SHIPMENT_FACT       = OB_SUPPLY.SHIPMENT_FACT
ORA_FULFILL.SHIPMENT_EVENT      = OB_STREAM.SHIPMENT_EVENT
ORA_FULFILL.SEQ_SHIPMENT        = OB_SUPPLY.SEQ_SHIPMENT
ORA_FULFILL.TRG_SHIPMENT_FACT_BI = OB_SUPPLY.TRG_SHIPMENT_FACT_BI
ORA_FULFILL.SP_CLOSE_SHIPMENT   = OB_SUPPLY.SP_CLOSE_SHIPMENT
ORA_FULFILL.VW_DUE_SHIPMENTS    = OB_ANALYTICS.VW_DUE_SHIPMENTS

# ORA_ANALYTICS views / procedures
ORA_ANALYTICS.VW_CUSTOMER_SPEND = OB_ANALYTICS.VW_CUSTOMER_SPEND
ORA_ANALYTICS.VW_REGION_PERF    = OB_ANALYTICS.VW_REGION_PERF
ORA_ANALYTICS.VW_DELIVERY_DELAY = OB_ANALYTICS.VW_DELIVERY_DELAY
ORA_ANALYTICS.SP_SNAPSHOT_FACTS = OB_ANALYTICS.SP_SNAPSHOT_FACTS

# ORA_AUDIT audit layer
ORA_AUDIT.AUDIT_LOG             = OB_AUDIT.AUDIT_LOG
ORA_AUDIT.JOB_RUN               = OB_AUDIT.JOB_RUN
ORA_AUDIT.SEQ_AUDIT             = OB_AUDIT.SEQ_AUDIT
ORA_AUDIT.SEQ_JOB               = OB_AUDIT.SEQ_JOB
ORA_AUDIT.TRG_AUDIT_LOG_BI      = OB_AUDIT.TRG_AUDIT_LOG_BI
ORA_AUDIT.SP_PURGE_AUDIT        = OB_AUDIT.SP_PURGE_AUDIT
ORA_AUDIT.FN_LAST_JOB_RUN       = OB_AUDIT.FN_LAST_JOB_RUN

# ORA_BILL finance layer
ORA_BILL.INVOICE_HEADER         = OB_BILL.INVOICE_HEADER
ORA_BILL.INVOICE_LINE           = OB_BILL.INVOICE_LINE
ORA_BILL.SEQ_INVOICE            = OB_BILL.SEQ_INVOICE
ORA_BILL.TRG_INVOICE_HEADER_BI  = OB_BILL.TRG_INVOICE_HEADER_BI
ORA_BILL.SP_POST_INVOICE        = OB_FIN.SP_POST_INVOICE
ORA_BILL.PKG_BILLING_ENGINE     = OB_FIN.PKG_BILLING_ENGINE
ORA_BILL.PKG_BILLING_ENGINE BODY = OB_FIN.PKG_BILLING_ENGINE BODY
ORA_BILL.VW_OVERDUE_INVOICE     = OB_FIN.VW_OVERDUE_INVOICE

# ORA_SEC security layer
ORA_SEC.USER_MATRIX             = OB_SEC.USER_MATRIX
ORA_SEC.ROLE_RIGHTS             = OB_SEC.ROLE_RIGHTS
ORA_SEC.SEQ_USER                = OB_SEC.SEQ_USER
ORA_SEC.SP_GRANT_ROLE           = OB_SEC.SP_GRANT_ROLE
ORA_SEC.FN_IS_AUTHORIZED        = OB_SEC.FN_IS_AUTHORIZED
ORA_SEC.VW_ACTIVE_USERS         = OB_SEC.VW_ACTIVE_USERS

# ORA_UTIL integration helpers
ORA_UTIL.SYN_CUSTOMER           = OB_SHARE.SYN_CUSTOMER
ORA_UTIL.SYN_ORDER              = OB_SHARE.SYN_ORDER
ORA_UTIL.SYN_INVOICE            = OB_SHARE.SYN_INVOICE
ORA_UTIL.SYN_REGION             = OB_SHARE.SYN_REGION
ORA_UTIL.FN_CANARY              = OB_SHARE.FN_CANARY
ORA_UTIL.PKG_DATA_ROUTER        = OB_SHARE.PKG_DATA_ROUTER
ORA_UTIL.PKG_DATA_ROUTER BODY   = OB_SHARE.PKG_DATA_ROUTER BODY

# ORA_ML machine learning metadata
ORA_ML.MODEL_VERSION            = OB_ML.MODEL_VERSION
ORA_ML.MODEL_FEATURE            = OB_ML.MODEL_FEATURE
ORA_ML.SEQ_MODEL                = OB_ML.SEQ_MODEL
ORA_ML.SP_REGISTER_MODEL        = OB_ML.SP_REGISTER_MODEL
ORA_ML.FN_SCORE_MODEL           = OB_ML.FN_SCORE_MODEL
ORA_ML.VW_FEATURE_COVERAGE      = OB_ANALYTICS.VW_FEATURE_COVERAGE

# --- Test Cases for Invalid Remap Rules (Added by Agent) ---

# Scenario 1: Extraneous Remap Rule (Source not found in Oracle)
# Expectation: Comparator should log a WARNING that ORA_CORE.NON_EXISTENT_TABLE is not found.
ORA_CORE.NON_EXISTENT_TABLE = OB_MASTER.NON_EXISTENT_TABLE

# Scenario 2: Malformed Remap Rule (Missing '=')
# Expectation: Comparator should log a WARNING for malformed line and skip it.
ORA_CORE.MALFORMED_RULE_1

# Scenario 3: Malformed Remap Rule (Missing target)
# Expectation: Comparator should log a WARNING for malformed line and skip it.
ORA_CORE.MALFORMED_RULE_2 =

# Scenario 4: Many-to-One Remap (Fatal Error)
# Expectation: Comparator should log a FATAL ERROR and exit (sys.exit(1))
# This maps two distinct Oracle tables to the same OceanBase target table.
ORA_CORE.CUSTOMER_DIM           = OB_MASTER.DUPLICATE_TARGET_TABLE
ORA_REF.REGION_DIM              = OB_MASTER.DUPLICATE_TARGET_TABLE